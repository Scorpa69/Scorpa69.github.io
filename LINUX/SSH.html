<!--
title: SSH
description: 
published: true
date: 2024-01-08T08:56:02.433Z
tags: 
editor: ckeditor
dateCreated: 2023-09-18T12:37:05.475Z
-->

<p>Augmentez le délai de connexion SSH</p>
<p>Sur le serveur, dirigez-vous vers le /etc/ssh/sshd_config fichier de configuration.</p>
<p>&nbsp;</p>
<p>$ nano /etc/ssh/sshd_config</p>
<p>Faites défiler et recherchez les paramètres suivants:</p>
<p>&nbsp;</p>
<p>#ClientIntervalAlive</p>
<p>#ClientAliveCountMax</p>
<p>le ClientIntervalAlive Le paramètre spécifie la durée en secondes pendant laquelle le serveur attendra avant d’envoyer un paquet nul au système client pour maintenir la connexion active.</p>
<p>&nbsp;</p>
<p>D’un autre côté, le ClientAliveCountMax Le paramètre définit le nombre de messages clients actifs qui sont envoyés sans recevoir de messages du client. Si cette limite est atteinte pendant l’envoi des messages, le sshd le démon abandonnera la session, mettant ainsi fin à la session ssh.</p>
<p>&nbsp;</p>
<p>La valeur de timeout est donnée par le produit des paramètres ci-dessus, c’est-à-dire</p>
<p>&nbsp;</p>
<p>Timeout value = ClientIntervalAlive * ClientAliveCountMax</p>
<p>Par exemple, supposons que vous ayez défini vos paramètres comme indiqué:</p>
<p>&nbsp;</p>
<p>ClientIntervalAlive&nbsp; 1200</p>
<p>ClientAliveCountMax 3</p>
<p>&nbsp;</p>
<p>le Temps libre la valeur sera 1200 secondes * 3 = 3600 secondes. C’est l’équivalent de 1 heure, ce qui implique que votre session ssh restera active pendant une période d’inactivité de 1 heure sans tomber.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<figure class="table">
  <table style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;">
    <tbody>
      <tr>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:2.2784in;">Path</td>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:1.1854in;">Permission linux</td>
      </tr>
      <tr>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:2.2784in;">.ssh directory (code)</td>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:1.1854in;">0700 (drwx------)</td>
      </tr>
      <tr>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:2.2784in;">private keys (ex: id_rsa) (code)</td>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:1.15in;">0600 (-rw-------)</td>
      </tr>
      <tr>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:2.2784in;">config</td>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:1.15in;">0600 (-rw-------)</td>
      </tr>
      <tr>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:2.2979in;">public keys (*.pub ex: id_rsa.pub)</td>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:1.1437in;">0644 (-rw-r--r--)</td>
      </tr>
      <tr>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:2.2784in;">authorized_keys (code)</td>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:1.1625in;">0644 (-rw-r--r--)</td>
      </tr>
      <tr>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:2.2784in;">known_hosts</td>
        <td style="border-bottom:1pt solid #A3A3A3;border-left:1pt solid #A3A3A3;border-right:1pt solid #A3A3A3;border-top:1pt solid #A3A3A3;padding:4pt;vertical-align:top;width:1.1625in;">0644 (-rw-r--r--)</td>
      </tr>
    </tbody>
  </table>
</figure>
<p>POUR CRÉER LA PAIRE DE CLE SE METTRE SUR UN SERVEUR LINUX ou Windows avec openssl installé puis :&nbsp;</p>
<p>ssh-keygen -t rsa -b 4096 -C A09_Admin</p>
<p>On peut laisser la passphrase vide</p>
<p>Choisir le dossier et le nom : /root/id_A09_Admin</p>
<p>nano /etc/ssh/sshd_config</p>
<p>Puis ajouter ou décommenter :</p>
<p>PasswordAuthentication yes</p>
<p>PermitRootLogin yes</p>
<p>ssh-copy-id -i "/root/id_A09_Admin.pub" root@127.0.0.1&nbsp; &nbsp;mais cela peut être n'importe quel serveur linux sur lequel on veut copier la clé ds les clé autorisées, il suffit de changer 127.0.0.1</p>
<p>WinSCP pour récupérer la paire de clé en local sur ma machine windows ou dans le dossier c:\users\a09\.ssh\ si c'est fait sous windows</p>
<p>nano /etc/ssh/sshd_config</p>
<p>Puis ajouter ou decomenter :</p>
<p>PasswordAuthentication yes</p>
<p>PermitRootLogin prohibit-password</p>
