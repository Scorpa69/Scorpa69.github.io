<!--
title: FRIGATE
description: 
published: true
date: 2023-09-18T12:36:33.438Z
tags: 
editor: ckeditor
dateCreated: 2023-09-18T12:36:32.226Z
-->

<p>K3s utilise Kubernetes sous le capot pour gérer les conteneurs, donc vous n'avez pas besoin de Docker Compose pour déployer des applications sur K3s. Au lieu de cela, vous pouvez utiliser des fichiers de déploiement Kubernetes pour déployer des applications sur K3s.</p>
<p>Ci-dessous, je vous donne un exemple de fichier de déploiement Kubernetes pour déployer l'application Frigate sur K3s :</p>
<pre><code class="language-plaintext">apiVersion: apps/v1
kind: Deployment
metadata:
  name: frigate
spec:
  replicas: 1
  selector:
    matchLabels:
      app: frigate
  template:
    metadata:
      labels:
        app: frigate
    spec:
      containers:
      - name: frigate
        image: blakeblackshear/frigate:latest
        imagePullPolicy: Always
        env:
        - name: MQTT_HOST
          value: mqtt://mqtt-broker:1883
        - name: FRIGATE_RTSP_PASSWORD
          valueFrom:
            secretKeyRef:
              name: frigate-secrets
              key: frigate_rtsp_password
        - name: FRIGATE_RTSP_USERNAME
          valueFrom:
            secretKeyRef:
              name: frigate-secrets
              key: frigate_rtsp_username
        - name: FRIGATE_MQTT_USERNAME
          valueFrom:
            secretKeyRef:
              name: frigate-secrets
              key: frigate_mqtt_username
        - name: FRIGATE_MQTT_PASSWORD
          valueFrom:
            secretKeyRef:
              name: frigate-secrets
              key: frigate_mqtt_password
        volumeMounts:
        - name: frigate-config
          mountPath: /config
        - name: frigate-media
          mountPath: /media
      volumes:
      - name: frigate-config
        configMap:
          name: frigate-config
      - name: frigate-media
        hostPath:
          path: /mnt/frigate/media
          type: Directory
---
apiVersion: v1
kind: Service
metadata:
  name: frigate
spec:
  selector:
    app: frigate
  ports:
    - name: http
      port: 5000
      targetPort: 5000
    - name: rtsp
      port: 7000
      targetPort: 7000
</code></pre>
<p>Ce fichier de déploiement Kubernetes déploie un conteneur Frigate et crée un service pour exposer l'application sur les ports 5000 et 7000. Vous pouvez enregistrer ce fichier sous le nom frigate.yaml et le déployer sur K3s en utilisant la commande suivante :</p>
<pre><code class="language-plaintext">kubectl apply -f frigate.yaml
</code></pre>
<p>Cela déploiera Frigate sur votre cluster K3s.</p>
