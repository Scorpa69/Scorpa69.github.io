<!--
title: IIS
description: 
published: true
date: 2023-11-16T10:19:02.652Z
tags: 
editor: ckeditor
dateCreated: 2023-09-18T12:38:24.515Z
-->

<h1>IIS WSUS</h1>
<p>Generate a SSL certificate</p>
<p>Click on your Server and select Server Certificates</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/Internet-Information-Services-IIS-Manager-Server-Certificates.png" alt="Internet Information Services (IIS) Manager - Server Certificates"></figure>
<p>Internet Information Services (IIS) Manager - Server Certificates</p>
<p>If you have your own PKI environment, follow these steps, if not, jump to step three</p>
<p>Click Create Domain Certificate on the right side</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/Internet-Information-Services-IIS-Manager-Server-Certificates-Create-Domain-Certificate.png" alt="Internet Information Services (IIS) Manager - Server Certificates - Create Domain Certificate"></figure>
<p>Internet Information Services (IIS) Manager - Server Certificates - Create Domain Certificate</p>
<p>Fill in the requested information on the Distinguished Name Properties page and click Next</p>
<p>Internet Information Services (IIS) Manager - Server Certificates - Distinguished Name Properties</p>
<p>Select your certificate authority and enter a friendly name (this can be anything), and then click Finish</p>
<p>Internet Information Services (IIS) Manager - Server Certificates - Create Domain Certificate - Online Certification Authority</p>
<p>If you need to submit a certificate request to an external certificate authority like Goaddy, Verisgn, Comodo; follow these steps</p>
<p>Click Create Certificate Request on the right side</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/Internet-Information-Services-IIS-Manager-Server-Certificates-Create-Certificate-Request.png" alt="Internet Information Services (IIS) Manager - Server Certificates - Create Certificate Request"></figure>
<p>Internet Information Services (IIS) Manager - Server Certificates - Create Certificate Request</p>
<p>Fill out the Distinguished Name Properties and click Next</p>
<p>Internet Information Services (IIS) Manager - Server Certificates - Request Certificate - Distinguished Name Properties</p>
<p>Change the Bit length to 2048 and click Next</p>
<p>Internet Information Services (IIS) Manager - Server Certificates - Request Certificate - Crytographic Service Provider Properties</p>
<p>Select a location on where to place the CSR file that will be generated by the wizard and click Finish</p>
<p>Internet Information Services (IIS) Manager - Server Certificates - Request Certificate - File Name</p>
<p>At this point, send the request to your certificate authority (like GoDaddy, Verisign, or your own internal certificate authority). You should receive back a .cer file once the claim has been fulfilled.</p>
<p>Click on Complete Certificate Request on the right side</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/Internet-Information-Services-IIS-Manager-Server-Certificates-Complete-Certificate-Request.png" alt="Internet Information Services (IIS) Manager - Server Certificates - Complete Certificate Request"></figure>
<p>Internet Information Services (IIS) Manager - Server Certificates - Complete Certificate Request</p>
<p>Select the .cer file that your public certificate authority provided you, type in a friendly name (this can be anything), select Web Hosting for the certificate store, and click OK</p>
<p>Internet Information Services (IIS) Manager - Server Certificates - Request Certificate - Specify Certificate Authority Response</p>
<p>Next, we need to bind the SSL certificate to your network adapter.</p>
<p>Expand your server, expand Sites, and select WSUS Administration</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/IIS-Sites-WSUS-Administration.png" alt="IIS - Sites - WSUS Administration"></figure>
<p>IIS - Sites - WSUS Administration</p>
<p>Select Bindings... on the right side</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/IIS-Bindings.png" alt="IIS - Bindings"></figure>
<p>IIS - Bindings</p>
<p>Select the https site and hit the Edit... button</p>
<p>Site Bindings - Port 8531</p>
<p>Select https for the type, select the SSL certificate you created above, and click OK</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/Site-Bindings-Port-8531.png" alt="Site Bindings - Port 8531"></figure>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/IIS-Edit-Site-Binding-WSUS.png" alt="IIS - Edit Site Binding - WSUS"></figure>
<p>IIS - Edit Site Binding - WSUS</p>
<p>Click Close on the Site Bindings window</p>
<p>IIS - Site Bindings - https</p>
<p>Next, we need to enforce SSL encryption on the following virtual roots</p>
<p>â€¢ ApiRemoting30</p>
<p>â€¢ ClientWebService</p>
<p>â€¢ DSSAuthWebService</p>
<p>â€¢ ServerSyncWebService</p>
<p>â€¢ SimpleAuthWebService</p>
<p>Expand WSUS Administration and foreach of the directories above, complete the following steps</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/IIS-WSUS-Administration.png" alt="IIS - WSUS Administration"></figure>
<p>Select the virtual site</p>
<p>IIS - WSUS Administration</p>
<p>Double click on SSL Settings</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/IIS-WSUS-Administration-SSL-Settings.png" alt="IIS - WSUS Administration - SSL Settings"></figure>
<p>IIS - WSUS Administration - SSL Settings</p>
<p>Check Require SSL and leave client certificates to ignore</p>
<p>IIS - WSUS Administration - SSL Settings - Require SSL</p>
<p>Click Apply in the top right corner</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/IIS-WSUS-Administration-SSL-Settings-Require-SSL.png" alt="IIS - WSUS Administration - SSL Settings - Require SSL"></figure>
<p>IIS - SSL Settings - Apply</p>
<p>Next, we need to execute a command to tell WSUS to use ssl</p>
<p>Open up an elevated command prompt</p>
<p>Server 2012 - Administrative Command Prompt</p>
<p>Navigate to your WSUS installation folder</p>
<p>cd "c:\Program Files\Update Services\Tools"</p>
<p>cmd - program files - update services - tools</p>
<p>Execute the following command (replace your server with the correct FQDN)</p>
<p>WSUSUtil.exe configuressl myserver.mydomain.local</p>
<p>wsusutil configuressl</p>
<p>Restart the WSUS server to make sure all changes take effect. &nbsp;You should be able to bring up the WSUS management console if all went well.</p>
<p>Configure your clients to connect via SSL to the WSUS server via Group Policy</p>
<p>Login to your domain controller</p>
<p>Open up Server Manager</p>
<p>Server 2012 R2 - Server Manager</p>
<p>Open up Group Policy Management</p>
<p>Server Manager - Tools - Group Policy Management</p>
<p>Right click on the policy you want to edit and select Edit</p>
<p>Edit GPO</p>
<p>Expand Computer Configuration -&gt; Polices -&gt; Administrative Templates -&gt; Windows Components -&gt; Windows Update</p>
<p>Double click on Specify intranet Microsoft update service location</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/Specify-intranet-Microsoft-update-service-location.png" alt="Specify intranet Microsoft update service location"></figure>
<p>Specify intranet Microsoft update service location</p>
<p>Change the intranet update service url to https and specify port 8531 and then click Apply.</p>
<figure class="image"><img src="https://jackstromberg.com/wp-content/uploads/2013/11/Specify-intranet-Microsoft-update-service-location-options.png" alt="Specify intranet Microsoft update service location - options"></figure>
<p>Specify intranet Microsoft update service location - options</p>
<p>That should do it! &nbsp;Try doing a gpupdate /force on your local machine and the check for windows updates. &nbsp;If windows successfully completes checking for updates, you should be good to go! ðŸ™‚</p>
<h1>IIS sur Server CORE</h1>
<p>Installer le rÃ´le IIS depuis server manager de son poste</p>
<p>Set-ExecutionPolicy RemoteSigned</p>
<p>import-module WebAdministration</p>
<p>get-command â€“pssnapin WebAdministration</p>
<p>start /w ocsetup IIS-ManagementService</p>
<p>reg add HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WebManagement\Server ^ /v EnableRemoteManagement /t REG_DWORD /d 1</p>
<p>net start wmsvc</p>
<p>&nbsp;</p>
<p>Ajouter la fonctionnalitÃ© IIS sur son poste</p>
<p>Installer l'extension inetmgr_amd64_fr-FR.msi sur son poste</p>
