<!--
title: EXCHANGE
description: 
published: true
date: 2023-09-25T07:32:10.285Z
tags: 
editor: ckeditor
dateCreated: 2023-09-25T07:17:50.204Z
-->

<h1>Echange Online :</h1>
<p>Pour se connecter il faut le module ExchangeOnlineManagement</p>
<h2>Se connecter :&nbsp;</h2>
<pre><code class="language-plaintext">Connect-ExchangeOnline -UserPrincipalName chris@contoso.com</code></pre>
<h2>Se déconnecter :</h2>
<pre><code class="language-plaintext">Disconnect-ExchangeOnline</code></pre>
<h2>Voir les quotas :</h2>
<pre><code class="language-plaintext">Get-Mailbox yrousvoal@absyscyborg.com | Select *quota*</code></pre>
<h2>Voir les dossiers contenant plus de 1Millions d'éléments :</h2>
<pre><code class="language-plaintext">Get-MailboxFolderStatistics -identity "yrousvoal@absyscyborg.com" | % {If ($_.ItemsInFolder -ge 1000000) {Write-Host "Folder with $("{0:N0}" -f $($_.ItemsInFolder)) items: '$($_.FolderPath)'" -ForegroundColor Red}}</code></pre>
<h2>Voir la rétention du journal d'audit d'une BAL :</h2>
<pre><code class="language-plaintext">Get-Mailbox yrousvoal@absyscyborg.com |select AuditLogAgeLimit</code></pre>
<h2>Mettre la rétention à 30 jours sur le journal d'audit d'une BAL :</h2>
<pre><code class="language-plaintext">Set-Mailbox yrousvoal@absyscyborg.com -AuditLogAgeLimit 30 -Force</code></pre>
