<!--
title: UPDATE
description: 
published: true
date: 2023-09-18T12:39:11.039Z
tags: 
editor: ckeditor
dateCreated: 2023-09-18T12:39:09.477Z
-->

<h1>UPDATE EN PS OS CLIENT :</h1>
<h2>Pour vérifier que le commande sont bien installées :</h2>
<pre><code class="language-plaintext">Get-Command -module windowsupdate</code></pre>
<h2>Pour installer le module :</h2>
<pre><code class="language-plaintext">Install-Module -Name PSWindowsUpdate</code></pre>
<h2>Pour importer le module :</h2>
<pre><code class="language-plaintext">Import-Module PSWindowsUpdate</code></pre>
<h2>Reboot en attente :</h2>
<pre><code class="language-plaintext">Get-WURebootStatus</code></pre>
<h2>Liste des MAJ disponible :</h2>
<pre><code class="language-plaintext">Get-WindowsUpdate</code></pre>
<h2>Installer les MAJ en acceptant et rebootant automatiquement :</h2>
<pre><code class="language-javascript">Install-WindowsUpdate -AcceptAll -AutoReboot</code></pre>
<h2>LAST REBOOT :</h2>
<pre><code class="language-plaintext">Get-CimInstance -ClassName win32_operatingsystem | select csname, lastbootuptime</code></pre>
<h2>Journal Windows Update :</h2>
<pre><code class="language-plaintext">Get-WindowsUpdateLog</code></pre>
<h2>Lister les MAJ installées récemment :</h2>
<pre><code class="language-plaintext">gwmi win32_quickfixengineering | sort installedon -desc</code></pre>
<p>ou</p>
<pre><code class="language-plaintext">Get-HotFix | Sort-Object -Property InstalledOn</code></pre>
<h2>Patch Sécu appliqué à une machine :</h2>
<pre><code class="language-plaintext">wmic qfe</code></pre>
<h1>UPDATE EN PS OS SERVER :</h1>
<h2>Lister le nombre de MAJ disponible :</h2>
<pre><code class="language-plaintext">$Updates = Start-WUScan
Write-Host "Updates Found: " $Updates.Count</code></pre>
<h2>Lister les MAJ :</h2>
<pre><code class="language-plaintext">Start-WUScan</code></pre>
<h2>Installer les MAJ :</h2>
<pre><code class="language-plaintext">Install-WUUpdates</code></pre>
<h2>Reboot en attente :</h2>
<pre><code class="language-plaintext">Get-WUIsPendingReboot</code></pre>
<h2>Lister les MAJ installées récemment :</h2>
<pre><code class="language-plaintext">gwmi win32_quickfixengineering | sort installedon -desc</code></pre>
<p>ou</p>
<pre><code class="language-plaintext">Get-HotFix | Sort-Object -Property InstalledOn</code></pre>
<h2>Version du client Windows Update :</h2>
<pre><code class="language-plaintext"> Get-WUAVersion</code></pre>
<h2>Retourne la date de la dernière vérification réussie Windows Update :</h2>
<pre><code class="language-plaintext">Get-WULastScanSuccessDate</code></pre>
<h2>Retourne la date de la dernière installation d'une mise à jour :</h2>
<pre><code class="language-plaintext">Get-WULastInstallationDate</code></pre>
<h2>Journal Windows Update :</h2>
<pre><code class="language-plaintext">Get-WindowsUpdateLog</code></pre>
<h2>Patch Sécu appliqué à une machine :</h2>
<pre><code class="language-plaintext">wmic qfe</code></pre>
