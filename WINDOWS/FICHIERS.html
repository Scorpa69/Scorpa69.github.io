<!--
title: FICHIERS
description: 
published: true
date: 2023-12-11T15:01:22.533Z
tags: ps, windows, powershell, commande
editor: ckeditor
dateCreated: 2023-09-18T12:38:12.624Z
-->

<h1>Ajouter du texte dans un fichier en CMD :</h1>
<p>Cette commande avec un seul signe "plus grand que"&nbsp; supprime tout le contenu de autoregistration.conf et ajoute “HostInterface=fqdn_machine” :</p>
<pre><code class="language-plaintext">echo HostInterface=%COMPUTERNAME%.%USERDNSDOMAIN% &gt; "c:\Program Files\Zabbix Agent 2\zabbix_agent2.d\autoregistration.conf</code></pre>
<p>Cette commande avec deux signes "plus grand que" ajoute la ligne indiqué à la fin du fichier en concervant l'existant :</p>
<pre><code class="language-plaintext">echo Tartempion &gt;&gt; c:\fichiers.txt</code></pre>
<p>&nbsp;</p>
<h1>Trouver AVHDX dans les CSV :</h1>
<p>Get-ChildItem -Path "<a href="file://scrbhyv01/c$/clusterstorage/">\\scrbhyv01\c$\clusterstorage\</a>"</p>
<p>&nbsp;</p>
<p>Get-ChildItem -Path "<a href="file://scrbhyv01/c$/clusterstorage/">\\scrbhyv01\c$\clusterstorage\</a>" -Filter *.avhdx -Recurse -ErrorAction SilentlyContinue -Force&nbsp;</p>
<p>&nbsp;</p>
<p>Export-Excel 'C:\Users\A09\Absys Cyborg\Teams DSI - Infra - DSI - Infra\Réseaux\</p>
<p>&nbsp;</p>
<p>Get-ChildItem -Path "<a href="file://scrbhyv01/c$/clusterstorage/">\\scrbhyv01\c$\clusterstorage\</a>" | ForEach-Object {Get-ChildItem -Filter *.avhdx -Recurse -ErrorAction SilentlyContinue -Force} | Export-Excel 'C:\Users\A09\Desktop\AVHDX.xlsx'</p>
<p>&nbsp;</p>
<p>for ($counter = 1; $counter -le 2; $counter++ ) {Get-ChildItem -Path "<a href="file://scrbhyv01/c$/clusterstorage/Volume$counter">\\scrbhyv01\c$\clusterstorage\Volume$counter</a>" -Filter *.avhdx -Recurse -ErrorAction SilentlyContinue -Force}</p>
<p>&nbsp;</p>
<p>for ($counter = 1; $counter -le 10; $counter++ ) {Get-ChildItem -Path "<a href="file://scrbhyv01/c$/clusterstorage/Volume$counter">\\scrbhyv01\c$\clusterstorage\Volume$counter</a>" -Filter *.avhdx -Recurse -ErrorAction SilentlyContinue -Force | Export-Excel 'C:\Users\A09\Desktop\AVHDX.xlsx' -WorksheetName Volume$counter}</p>
<p>&nbsp;</p>
<h1>EQUICALENT DE CAT EN LINUX :</h1>
<p>type chemindufichiers\nomdufichier</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>DEPLACEMENT: Attention à ce que la destination existe bien car sinon les fichier sont perdues</h1>
<p>Get-ChildItem -Path ".\*.txt" -Recurse | Move-Item -Destination "C:\TextFiles" =&gt; déplace tous les fichier texte du rep courant vers c:\textfiles</p>
<p>&nbsp;</p>
<p>Get-ChildItem -Path "<a href="file://vdcsfic01/c$/users/a09_admin/documents/*.txt">\\vdcsfic01\c$\users\a09_admin\documents\*.txt</a>" | Move-Item -Destination "C:\users\a09\desktop\Journaux"</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1>COPY :</h1>
<p>Copy-Item -path cheminsource -destination chemindestination</p>
<p>&nbsp;</p>
<p>Copy-Item -path <a href="file://nas.arcadie-informatique.net/sauvegardes/jmc.txt">\\nas.arcadie-informatique.net\sauvegardes\jmc.txt</a> -destination c:\users\a09\desktop</p>
<p>&nbsp;</p>
<p>Copy-Item -path <a href="file://svdahyv01/MSSCVMMLibrary$/ISOs/2019/SW_DVD5_Sys_Ctr_ConfigMgrClt_ML_1902_MultiLang_ConfMgr_SCEP_MLF_X22-04818.ISO">\\svdahyv01\MSSCVMMLibrary$\ISOs\2019\SW_DVD5_Sys_Ctr_ConfigMgrClt_ML_1902_MultiLang_ConfMgr_SCEP_MLF_X22-04818.ISO</a> -destination c:\users\a09\desktop</p>
<p>&nbsp;</p>
<p>Copy-Item -path <a href="file://svdahyv01/MSSCVMMLibrary$/ISOs/Autres/debian-10.4.0-amd64-netinst.iso">\\svdahyv01\MSSCVMMLibrary$\ISOs\Autres\debian-10.4.0-amd64-netinst.iso</a> -destination c:\users\a09\desktop</p>
<p>&nbsp;</p>
<p>Copy-Item -path <a href="file://svdahyv01/MSSCVMMLibrary$/ISOs/">\\svdahyv01\MSSCVMMLibrary$\ISOs\</a> -destination c:\users\a09\desktop</p>
<p>&nbsp;</p>
<p>Copy-Item -path C:\Users\A09\Nextcloud\1-INFRA_AC\Projet\Zabbix\Fichiers conf\zabbix_agent2.conf -destination <a href="file://cyborg.dom/deploy$/Zabbix/Conf">\\cyborg.dom\deploy$\Zabbix\Conf</a></p>
<p>&nbsp;</p>
<p>Copy-Item -path 'C:\Users\A09\Nextcloud\1-INFRA_AC\Projet\Zabbix\Fichiers conf\zabbixconfv2.bat' -destination <a href="file://cyborg.dom/deploy$/Zabbix/Conf/zabbixconf.bat">\\cyborg.dom\deploy$\Zabbix\Conf\zabbixconf.bat</a></p>
<p>&nbsp;</p>
<p>Copy-Item -path 'C:\Users\A09\Nextcloud\1-INFRA_AC\Projet\Zabbix\Agent\zabbix_agent2-5.0.8-windows-amd64-openssl.msi' -destination <a href="file://cyborg.dom/deploy$/Zabbix/5.0.8/zabbix_agent2-5.0.8-windows-amd64-openssl.msi">\\cyborg.dom\deploy$\Zabbix\5.0.8\zabbix_agent2-5.0.8-windows-amd64-openssl.msi</a></p>
<p>&nbsp;</p>
<p>Copy-Item -path 'C:\Users\A09\Nextcloud\1-INFRA_AC\Projet\Zabbix\Agent\zabbix_agent2-5.0.9-windows-i386-openssl.msi -destination <a href="file://cyborg.dom/deploy$/Zabbix/5.0.9/">\\cyborg.dom\deploy$\Zabbix\5.0.9\</a></p>
<p>&nbsp;</p>
<p>Copy-Item -path <a href="file://cyborg.dom/deploy$/Zabbix/5.0.17/zabbix_agent2-5.0.17-windows-amd64-openssl.msi">\\cyborg.dom\deploy$\Zabbix\5.0.17\zabbix_agent2-5.0.17-windows-amd64-openssl.msi</a> c:\Users\A09_admin\Documents\zabbix_agent2-5.0.17-windows-amd64-openssl.msi</p>
<p>&nbsp;</p>
<p>Copy-Item -path <a href="file://cyborg.dom/deploy$/Zabbix/conf.d/Maj001/autoregistration.conf">\\cyborg.dom\deploy$\Zabbix\conf.d\Maj001\autoregistration.conf</a> 'C:\Program Files\Zabbix Agent 2\zabbix_agent2.d'</p>
<p>&nbsp;</p>
<p>Copy-Item -path C:\Users\A09\Nextcloud\1-INFRA_AC\Projet\Zabbix\InstallManV1.cmd <a href="file://vtlsads01/c$/users/a09_admin/documents/InstallManV1.cmd">\\vtlsads01\c$\users\a09_admin\documents\InstallManV1.cmd</a></p>
<p>Copy-Item -path <a href="file://cyborg.dom/deploy$/Zabbix/5.0.17/zabbix_agent2-5.0.17-windows-amd64-openssl.msi">\\cyborg.dom\deploy$\Zabbix\5.0.17\zabbix_agent2-5.0.17-windows-amd64-openssl.msi</a><a href="file://vtlsads01/c$/users/a09_admin/documents/zabbix_agent2-5.0.17-windows-amd64-openssl.msi">\\vtlsads01\c$\users\a09_admin\documents\zabbix_agent2-5.0.17-windows-amd64-openssl.msi</a></p>
<p>&nbsp;</p>
<p>Copy-Item -path <a href="file://cyborg.dom/deploy$/Zabbix/conf.d/Maj001/autoregistration.conf">\\cyborg.dom\deploy$\Zabbix\conf.d\Maj001\autoregistration.conf</a><a href="file://vrbxroc01/c$/Program%20Files/Zabbix%20Agent%202/zabbix_agent2.d/autoregistration.conf">\\vrbxroc01\c$\Program Files\Zabbix Agent 2\zabbix_agent2.d\autoregistration.conf</a></p>
<p>&nbsp;</p>
<h1>AFFICHAGE CONTENU DOSSIER :</h1>
<p>Get-ChildItem -Force <a href="file://cyborg.dom/deploy$">\\cyborg.dom\deploy$</a> -Recurse</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Get-ChildItem <a href="file://scrbhyv01/c$/ClusterStorage/Volume6">\\scrbhyv01\c$\ClusterStorage\Volume6</a></p>
<p>&nbsp;</p>
<h1>SUPPRESSION FICHIER ET DOSSIER :</h1>
<p>Remove-Item -Recurse -Confirm <a href="file://scrbhyv01/c$/ClusterStorage/Volume">\\scrbhyv01\c$\ClusterStorage\Volume</a></p>
<p>&nbsp;</p>
<p>Remove-Item -Recurse -Confirm <a href="file://sidfhyv02/c$/ClusterStorage/volume2/VMDS1K">\\sidfhyv02\c$\ClusterStorage\volume2\VMDS1K</a></p>
<p>&nbsp;</p>
<p>Remove-item c:\users\a09_admin\desktop\sbrehyv01.csv</p>
<p>&nbsp;</p>
<p>Remove-item c:\Users\A09_admin\Documents\zabbix_agent2-5.0.17-windows-amd64-openssl.msi</p>
<p>&nbsp;</p>
<h1>RENOMMER FICHIER :</h1>
<p>Rename-Item -Path "<a href="file://fs/Shared/temp.txt">\\fs\Shared\temp.txt</a>" -NewName "new_temp.txt"</p>
<p>&nbsp;</p>
<h1>RENOMMER DOSSIER :</h1>
<p>Rename-Item -Path "<a href="file://scrbhyv01/c$/ClusterStorage/Volume6/VDCSTPM01/">\\scrbhyv01\c$\ClusterStorage\Volume6\VDCSTPM01\</a>" -NewName "VDCSTPM01TODELETE"</p>
<p>&nbsp;</p>
<p>Rename-item -path c:\users\a09\desktop\DPM -newname DataProtectionManager</p>
<p>&nbsp;</p>
<p>Rename-Item -Path "<a href="file://scrbhyv01/c$/ClusterStorage/Volume8/DPM_12-11-2020_22.5.2/">\\scrbhyv01\c$\ClusterStorage\Volume8\DPM_12-11-2020_22.5.2\</a>" -NewName "VDCSVPS01_12-11-2020_22-5-2"</p>
<p>&nbsp;</p>
<p>Rename-Item -Path "<a href="file://scrbhyv01/c$/ClusterStorage/Volume8/VDCSVPS01-RESTO/WS">\\scrbhyv01\c$\ClusterStorage\Volume8\VDCSVPS01-RESTO\WS</a>" -NewName "OS_Resto.vhdx"</p>
<p>&nbsp;</p>
<h1>CRÉER DOSSIER :</h1>
<p>New-Item -Path '<a href="file://fs/Shared/NewFolder">\\fs\Shared\NewFolder</a>' -ItemType Directory</p>
<p>&nbsp;</p>
<p>New-Item -Path '<a href="file://cyborg.dom/deploy$/Zabbix/Script">\\cyborg.dom\deploy$\Zabbix\Script</a>' -ItemType Directory</p>
<p>&nbsp;</p>
<p>New-Item -Path '<a href="file://cyborg.dom/deploy$/Zabbix/5.0.9">\\cyborg.dom\deploy$\Zabbix\5.0.9</a>' -ItemType Directory</p>
<p>&nbsp;</p>
<h1>CRÉER FICHIER :</h1>
<p>New-Item -Path '<a href="file://fs/Shared/NewFolder/newfile.txt">\\fs\Shared\NewFolder\newfile.txt</a>' -ItemType File</p>
<p>&nbsp;</p>
<h1>DEPLACER DOSSIER:</h1>
<p>Move-Item -Path <a href="file://fs/Shared/Backups/">\\fs\Shared\Backups\</a> -Destination <a href="file://fs2/Backups/archive/">\\fs2\Backups\archive\</a></p>
<p>&nbsp;</p>
<h1>DEPLACER FICHIER</h1>
<p>Move-Item -Path <a href="file://cyborg.dom/deploy$/Zabbix/Conf/zabbixconf.bat">\\cyborg.dom\deploy$\Zabbix\Conf\zabbixconf.bat</a> -Destination <a href="file://cyborg.dom/deploy$/Zabbix/script/zabbixconf.bat">\\cyborg.dom\deploy$\Zabbix\script\zabbixconf.bat</a></p>
