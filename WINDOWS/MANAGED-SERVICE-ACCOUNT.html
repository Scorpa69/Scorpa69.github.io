<!--
title: MANAGED SERVICE ACCOUNT
description: 
published: true
date: 2023-11-07T10:28:45.722Z
tags: 
editor: ckeditor
dateCreated: 2023-09-18T12:38:40.032Z
-->

<h1>Intro</h1>
<p>Les msa et gmsa sont des comptes de services complètement géré par l'AD (mdp de 240 caractères renouveler tous les 30 jours), ils sont souvent utilisés pour sql server.</p>
<pre><code class="language-plaintext">Import-Module ActiveDirectory</code></pre>
<h1>Création MSA</h1>
<pre><code class="language-plaintext">New-ADServiceAccount ‘WSUS_VDCSWSU01’ -Enabled $true -RestrictToSingleComputer -KerberosEncryptionType AES256 -Description 'VDCSWSU01 | Compte de service sql server pour WSUS'</code></pre>
<h1>Info MSA</h1>
<pre><code class="language-plaintext">Get-AdServiceAccount WSUS_VDCSWSU01</code></pre>
<h1>Association avec la cible (serveur)</h1>
<pre><code class="language-plaintext">Add-ADComputerServiceAccount -Computer VDCSWSU01 -ServiceAccount WSUS_VDCSWSU01</code></pre>
<h1>Install sur la cible à faire en local</h1>
<pre><code class="language-plaintext">Install-AdServiceAccount -identity WSUS_VDCSWSU01</code></pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>VOIR LISTE DES SERVEUR DU GROUP</p>
<p>Get-ADServiceAccount [-Identity] ITFarm1 -Properties PrincipalsAllowedToRetrieveManagedPassword</p>
<p>METTRE LES TROIS SERVEUR DANS LA LISTE DU GROUP (inclure ceux existants dans liste déclaré)</p>
<p>Set-ADServiceAccount [-Identity] ITFarm1 -PrincipalsAllowedToRetrieveManagedPassword Host1$,Host2$,Host3$</p>
